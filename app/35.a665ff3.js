(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{349:function(e,n,t){"use strict";t.r(n);var o=t(3),c=t(2),r=t(5),a=function(e,n,t,o){return new(t||(t=Promise))((function(c,r){function a(e){try{u(o.next(e))}catch(e){r(e)}}function i(e){try{u(o.throw(e))}catch(e){r(e)}}function u(e){var n;e.done?c(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((o=o.apply(e,n||[])).next())}))};var i=function(e,n,t,o){return new(t||(t=Promise))((function(c,r){function a(e){try{u(o.next(e))}catch(e){r(e)}}function i(e){try{u(o.throw(e))}catch(e){r(e)}}function u(e){var n;e.done?c(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((o=o.apply(e,n||[])).next())}))};var u=function(e,n,t,o){return new(t||(t=Promise))((function(c,r){function a(e){try{u(o.next(e))}catch(e){r(e)}}function i(e){try{u(o.throw(e))}catch(e){r(e)}}function u(e){var n;e.done?c(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((o=o.apply(e,n||[])).next())}))};var s=function(e,n,t,o){return new(t||(t=Promise))((function(c,r){function a(e){try{u(o.next(e))}catch(e){r(e)}}function i(e){try{u(o.throw(e))}catch(e){r(e)}}function u(e){var n;e.done?c(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((o=o.apply(e,n||[])).next())}))};var l,d,f,v,w,m=function(e,n,t,o){return new(t||(t=Promise))((function(c,r){function a(e){try{u(o.next(e))}catch(e){r(e)}}function i(e){try{u(o.throw(e))}catch(e){r(e)}}function u(e){var n;e.done?c(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,i)}u((o=o.apply(e,n||[])).next())}))};null===(l=document.querySelector("#reset-avatar"))||void 0===l||l.addEventListener("click",(function(){return a(this,void 0,void 0,(function*(){try{yield Object(o.a)({text:Object(c.a)("user.resetAvatarConfirm")})}catch(e){return}const{message:e}=yield Object(r.c)("/user/profile/avatar",{tid:0});o.b.success(e),document.querySelectorAll('[alt="User Image"]').forEach(e=>{e.src+=`?${(new Date).getTime()}`})}))})),null===(d=document.querySelector("#change-password"))||void 0===d||d.addEventListener("submit",(function(e){return i(this,void 0,void 0,(function*(){e.preventDefault();const n=e.target,t=n.oldPassword.value,a=n.newPassword.value;if(a!==n.confirm.value)return o.b.error(Object(c.a)("auth.invalidConfirmPwd")),void n.confirm.focus();const{code:i,message:u}=yield Object(r.c)("/user/profile?action=password",{current_password:t,new_password:a});yield Object(o.a)({mode:"alert",text:u}),0===i&&(window.location.href=`${blessing.base_url}/auth/login`)}))})),null===(f=document.querySelector("#change-nickname"))||void 0===f||f.addEventListener("submit",(function(e){return u(this,void 0,void 0,(function*(){e.preventDefault();const n=e.target.nickname.value,{code:t,message:c}=yield Object(r.c)("/user/profile?action=nickname",{new_nickname:n});Object(o.a)({mode:"alert",text:c}),0===t&&document.querySelectorAll('[data-mark="nickname"]').forEach(e=>{e.textContent=n})}))})),null===(v=document.querySelector("#change-email"))||void 0===v||v.addEventListener("submit",(function(e){return s(this,void 0,void 0,(function*(){e.preventDefault();const n=e.target,t=n.email.value,c=n.password.value,{code:a,message:i}=yield Object(r.c)("/user/profile?action=email",{new_email:t,password:c});yield Object(o.a)({mode:"alert",text:i}),0===a&&(window.location.href=`${blessing.base_url}/auth/login`)}))})),null===(w=document.querySelector("#modal-delete-account"))||void 0===w||w.addEventListener("submit",(function(e){return m(this,void 0,void 0,(function*(){e.preventDefault();const n=e.target.password.value,{code:t,message:c}=yield Object(r.c)("/user/profile?action=delete",{password:n});yield Object(o.a)({mode:"alert",text:c}),0===t&&(window.location.href=blessing.base_url)}))}))}}]);