(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{127:function(e,t,i){var a=i(334);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i(8).default)("08daabf4",a,!0,{})},32:function(e,t,i){"use strict";var a=i(1),s=i(4);t.a=a.a.extend({mounted(){s.a("mounted",{el:this.$root.$options.el})}})},333:function(e,t,i){"use strict";var a=i(127);i.n(a).a},334:function(e,t,i){(t=i(7)(!1)).push([e.i,".file-dnd {\n  min-height: 256px;\n  margin-bottom: 15px;\n  border: 1px solid #ddd;\n  border-radius: 2px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.file-dnd h3 {\n  color: #aaa;\n}\n.bottom-notice {\n  margin-top: 10px;\n}\n",""]),e.exports=t},366:function(e,t,i){"use strict";i.r(t);var a=i(332),s=i.n(a),n=i(134),l=i(53),r=i(32),o=i(3),c={name:"Upload",components:{FileUpload:s.a,Portal:l.a,Previewer:()=>i.e(23).then(i.bind(null,335))},mixins:[r.a],data:()=>({name:"",type:"steve",isPrivate:!1,files:[],texture:"",uploading:!1,textureNameRule:blessing.extra.rule,privacyNotice:blessing.extra.privacyNotice,scorePublic:blessing.extra.scorePublic,scorePrivate:blessing.extra.scorePrivate,award:blessing.extra.award,contentPolicy:blessing.extra.contentPolicy,width2d:64,disablePortal:!1}),computed:{scoreCost(){return(Math.round(this.files[0].size/1024)||1)*(this.isPrivate?this.scorePrivate:this.scorePublic)},hasFile(){return this.files[0]}},methods:{async upload(){if(!this.hasFile)return void o.b.error(this.$t("skinlib.emptyUploadFile"));if(!this.name)return void o.b.error(this.$t("skinlib.emptyTextureName"));if(!/image\/(x-)?png/.test(this.files[0].type))return void o.b.error(this.$t("skinlib.fileExtError"));const e=new FormData;e.append("name",this.name),e.append("type",this.type),e.append("file",this.files[0].file,this.files[0].name),e.append("public",!this.isPrivate),this.uploading=!0;const{code:t,message:i,data:{tid:a}={tid:0}}=await this.$http.post("/skinlib/upload",e);0===t?window.location=`${blessing.base_url}/skinlib/show/${a}`:(o.b.error(i),this.uploading=!1)},inputFile(e){if(!e)return;if(!this.name){const t=/(.*)\.png$/i.exec(e.name);this.name=t?t[1]:e.name}this.texture=URL.createObjectURL(e.file);const t=new Image;t.src=this.texture,t.onload=()=>{this.width2d=t.width>400?400:t.width,this.type=Object(n.g)(t)?"alex":"steve"}},remove(){this.$refs.upload.clear(),this.texture=""}}},d=(i(333),i(10)),p=Object(d.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("portal",{attrs:{selector:"#file-input",disabled:e.disablePortal}},[i("div",{staticClass:"card card-primary"},[i("div",{staticClass:"card-body"},[i("div",{staticClass:"form-group"},[i("label",{directives:[{name:"t",rawName:"v-t",value:"skinlib.upload.texture-name",expression:"'skinlib.upload.texture-name'"}],attrs:{for:"name"}}),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form-control",attrs:{type:"text",placeholder:e.textureNameRule},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),e._v(" "),i("div",{staticClass:"form-group"},[i("label",{directives:[{name:"t",rawName:"v-t",value:"skinlib.upload.texture-type",expression:"'skinlib.upload.texture-type'"}]}),e._v(" "),i("br"),e._v(" "),i("label",{staticClass:"mr-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"type"}],attrs:{type:"radio",name:"type",value:"steve"},domProps:{checked:e._q(e.type,"steve")},on:{change:function(t){e.type="steve"}}}),e._v("\n            Steve\n          ")]),e._v(" "),i("label",{staticClass:"mr-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"type"}],attrs:{type:"radio",name:"type",value:"alex"},domProps:{checked:e._q(e.type,"alex")},on:{change:function(t){e.type="alex"}}}),e._v("\n            Alex\n          ")]),e._v(" "),i("label",{staticClass:"mr-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"type"}],attrs:{type:"radio",name:"type",value:"cape"},domProps:{checked:e._q(e.type,"cape")},on:{change:function(t){e.type="cape"}}}),e._v("\n            "+e._s(e.$t("general.cape"))+"\n          ")])]),e._v(" "),i("div",{staticClass:"form-group"},[i("label",{directives:[{name:"t",rawName:"v-t",value:"skinlib.upload.select-file",expression:"'skinlib.upload.select-file'"}],attrs:{for:"file"}}),e._v(" "),i("div",{staticClass:"file-dnd"},[e.hasFile?i("img",{attrs:{src:e.texture,width:e.width2d}}):i("h3",{directives:[{name:"t",rawName:"v-t",value:"skinlib.upload.dropZone",expression:"'skinlib.upload.dropZone'"}]})]),e._v(" "),i("file-upload",{ref:"upload",attrs:{extensions:"png",accept:"image/png,image/x-png",drop:".file-dnd"},on:{"input-file":e.inputFile},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}},[i("button",{staticClass:"btn btn-primary"},[e._v("\n              "+e._s(e.$t("skinlib.upload.select-file"))+"\n            ")])]),e._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:e.hasFile,expression:"hasFile"}],staticClass:"btn btn-danger float-right",attrs:{"data-test":"remove"},on:{click:e.remove}},[i("i",{staticClass:"fas fa-trash-alt"}),e._v("\n            "+e._s(e.$t("skinlib.upload.remove"))+"\n          ")])],1),e._v(" "),e.contentPolicy?i("div",{staticClass:"callout callout-warning",domProps:{innerHTML:e._s(e.contentPolicy)}}):e._e()]),e._v(" "),i("div",{staticClass:"card-footer"},[i("div",{staticClass:"container pl-0 pr-0 d-flex justify-content-between"},[i("label",{staticClass:"mt-2",attrs:{title:e.$t("skinlib.upload.privacy-notice"),"data-toggle":"tooltip"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.isPrivate,expression:"isPrivate"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isPrivate)?e._i(e.isPrivate,null)>-1:e.isPrivate},on:{change:function(t){var i=e.isPrivate,a=t.target,s=!!a.checked;if(Array.isArray(i)){var n=e._i(i,null);a.checked?n<0&&(e.isPrivate=i.concat([null])):n>-1&&(e.isPrivate=i.slice(0,n).concat(i.slice(n+1)))}else e.isPrivate=s}}}),e._v("\n            "+e._s(e.$t("skinlib.upload.set-as-private"))+"\n          ")]),e._v(" "),e.uploading?i("button",{staticClass:"btn btn-success",attrs:{disabled:""}},[i("i",{staticClass:"fa fa-spinner fa-spin"}),e._v(" "+e._s(e.$t("skinlib.uploading"))+"\n          ")]):i("button",{staticClass:"btn btn-success",on:{click:e.upload}},[e._v("\n            "+e._s(e.$t("skinlib.upload.button"))+"\n          ")])]),e._v(" "),e.hasFile?i("div",{staticClass:"callout callout-info bottom-notice"},[i("p",[e._v(e._s(e.$t("skinlib.upload.cost",{score:e.scoreCost})))])]):e._e(),e._v(" "),e.isPrivate?i("div",{staticClass:"callout callout-info bottom-notice"},[i("p",[e._v(e._s(e.privacyNotice))])]):e._e(),e._v(" "),!e.isPrivate&&e.award?i("div",{staticClass:"callout callout-success bottom-notice"},[i("p",[e._v(e._s(e.$t("skinlib.upload.award",{score:e.award})))])]):e._e()])])]),e._v(" "),i("portal",{attrs:{selector:"#previewer",disabled:e.disablePortal}},[i("previewer",{attrs:{skin:"cape"!==e.type?e.texture:"",cape:"cape"===e.type?e.texture:"",model:e.type}})],1)],1)}),[],!1,null,null,null);t.default=p.exports},53:function(e,t,i){"use strict";var a=i(1);t.a=a.a.extend({name:"Portal",props:{selector:{required:!0,type:String},tag:{type:String,default:"div"},disabled:{type:Boolean,default:!1}},mounted(){if(this.disabled)return;const e=document.querySelector(this.selector);e&&(e.firstChild?e.replaceChild(this.$el,e.firstChild):e.appendChild(this.$el))},render(e){return e(this.tag,[this.$slots.default])}})}}]);