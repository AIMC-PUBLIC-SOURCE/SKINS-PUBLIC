(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{116:function(e,t,a){var n=a(322);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(8).default)("1af496f6",n,!0,{})},32:function(e,t,a){"use strict";var n=a(1),s=a(4);t.a=n.a.extend({mounted(){s.a("mounted",{el:this.$root.$options.el})}})},321:function(e,t,a){"use strict";var n=a(116);a.n(n).a},322:function(e,t,a){(t=a(7)(!1)).push([e.i,".operations-menu {\n  margin-left: -35px;\n}\n.fa-edit {\n  cursor: pointer;\n}\n.fa-toggle-on,\n.fa-toggle-off {\n  font-size: 18px;\n  cursor: pointer;\n}\n.row-at-bottom {\n  margin-top: -100px;\n}\n",""]),e.exports=t},355:function(e,t,a){"use strict";a.r(t);var n=a(55),s=(a(54),a(2)),i=a(11),r=a(42),o=a(75),c=a(32),d=a(3),l=a(43),u={name:"UsersManagement",components:{Modal:i.a,VueGoodTable:n.a},filters:{humanizePermission(e){switch(e.permission){case-1:return Object(s.a)("admin.banned");case 0:return Object(s.a)("admin.normal");case 1:return Object(s.a)("admin.admin");case 2:return Object(s.a)("admin.superAdmin");default:return""}},playersLink:e=>`${blessing.base_url}/admin/players?uid=${e.uid}`},mixins:[c.a,r.a,o.a],data(){return{users:[],columns:[{field:"uid",label:"UID",type:"number"},{field:"email",label:this.$t("general.user.email")},{field:"nickname",label:this.$t("general.user.nickname"),width:"150px"},{field:"score",label:this.$t("general.user.score"),type:"number",width:"102px"},{field:"players_count",label:this.$t("admin.playersCount"),type:"number",sortable:!1},{field:"permission",label:this.$t("admin.permission"),globalSearchDisabled:!0},{field:"verified",label:this.$t("admin.verification"),type:"boolean",globalSearchDisabled:!0},{field:"register_at",label:this.$t("general.user.register-at")},{field:"operations",label:this.$t("admin.operationsTitle"),sortable:!1,globalSearchDisabled:!0}],editingUser:{},permission:0}},beforeMount(){this.fetchData()},methods:{async fetchData(){const{data:e,totalRecords:t}=await this.$http.get(`/admin/users/list${location.search}`,!location.search&&this.serverParams);this.totalRecords=t,this.users=e},async changeEmail(e){let t;try{({value:t}=await Object(d.a)({mode:"prompt",text:this.$t("admin.newUserEmail"),input:e.email,validator:Object(l.a)(this.$t("auth.emptyEmail"))}))}catch{return}const{code:a,message:n}=await this.$http.post("/admin/users?action=email",{uid:e.uid,email:t});0===a?(e.email=t,d.b.success(n)):d.b.error(n)},async toggleVerification(e){const{code:t,message:a}=await this.$http.post("/admin/users?action=verification",{uid:e.uid});0===t?(e.verified=!e.verified,d.b.success(a)):d.b.error(a)},async changeNickName(e){let t;try{({value:t}=await Object(d.a)({mode:"prompt",text:this.$t("admin.newUserNickname"),input:e.nickname,validator:Object(l.a)(this.$t("auth.emptyNickname"))}))}catch{return}const{code:a,message:n}=await this.$http.post("/admin/users?action=nickname",{uid:e.uid,nickname:t});0===a?(e.nickname=t,d.b.success(n)):d.b.error(n)},async changePassword(e){let t;try{({value:t}=await Object(d.a)({mode:"prompt",text:this.$t("admin.newUserPassword"),inputType:"password"}))}catch{return}const{code:a,message:n}=await this.$http.post("/admin/users?action=password",{uid:e.uid,password:t});0===a?d.b.success(n):d.b.error(n)},async changeScore(e){let t;try{({value:t}=await Object(d.a)({mode:"prompt",text:this.$t("admin.newScore"),input:e.score,inputType:"number"}))}catch{return}const a=Number.parseInt(t),{code:n,message:s}=await this.$http.post("/admin/users?action=score",{uid:e.uid,score:a});0===n?(e.score=a,d.b.success(s)):d.b.error(s)},async changePermission(){const e=Number.parseInt(this.permission),{code:t,message:a}=await this.$http.post("/admin/users?action=permission",{uid:this.editingUser.uid,permission:e});0===t?(this.editingUser.permission=e,d.b.success(a)):d.b.error(a)},async deleteUser({uid:e,originalIndex:t}){try{await Object(d.a)({text:this.$t("admin.deleteUserNotice"),okButtonType:"danger"})}catch{return}const{code:a,message:n}=await this.$http.post("/admin/users?action=delete",{uid:e});0===a?(this.$delete(this.users,t),d.b.success(n)):d.b.error(n)}}},m=(a(321),a(10)),p=Object(m.a)(u,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid"},[a("vue-good-table",{attrs:{mode:"remote",rows:e.users,"total-rows":e.totalRecords||e.users.length,columns:e.columns,"search-options":e.tableOptions.search,"pagination-options":e.tableOptions.pagination,"style-class":"vgt-table striped"},on:{"on-page-change":e.onPageChange,"on-sort-change":e.onSortChange,"on-search":e.onSearch,"on-per-page-change":e.onPerPageChange},scopedSlots:e._u([{key:"table-row",fn:function(t){return["email"===t.column.field?a("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),a("a",{attrs:{title:e.$t("admin.changeEmail"),"data-test":"email"},on:{click:function(a){return e.changeEmail(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"nickname"===t.column.field?a("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),a("a",{attrs:{title:e.$t("admin.changeNickName"),"data-test":"nickname"},on:{click:function(a){return e.changeNickName(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"score"===t.column.field?a("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),a("a",{attrs:{title:e.$t("admin.changeScore"),"data-test":"score"},on:{click:function(a){return e.changeScore(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"players_count"===t.column.field?a("span",[a("a",{attrs:{href:e._f("playersLink")(t.row),title:e.$t("admin.inspectHisPlayers"),"data-toggle":"tooltip","data-placement":"right"}},[e._v(e._s(t.formattedRow[t.column.field]))])]):"permission"===t.column.field?a("span",[a("span",[e._v(e._s(e._f("humanizePermission")(t.row)))]),e._v(" "),t.row.permission<1||2===t.row.operations&&t.row.permission<2?a("a",{attrs:{title:e.$t("admin.changePermission"),"data-toggle":"modal","data-target":"#modal-permission","data-test":"permission"},on:{click:function(a){e.editingUser=t.row,e.permission=t.row.permission}}},[a("i",{staticClass:"fas fa-edit btn-edit"})]):e._e()]):"verified"===t.column.field?a("span",[t.row.verified?a("span",{directives:[{name:"t",rawName:"v-t",value:"admin.verified",expression:"'admin.verified'"}]}):a("span",{directives:[{name:"t",rawName:"v-t",value:"admin.unverified",expression:"'admin.unverified'"}]}),e._v(" "),a("a",{attrs:{title:e.$t("admin.toggleVerification"),"data-test":"verification"},on:{click:function(a){return e.toggleVerification(t.row)}}},[a("i",{staticClass:"fas btn-edit",class:{"fa-toggle-on":t.row.verified,"fa-toggle-off":!t.row.verified}})])]):"operations"===t.column.field?a("div",[a("button",{staticClass:"btn btn-default",on:{click:function(a){return e.changePassword(t.row)}}},[e._v("\n          "+e._s(e.$t("admin.changePassword"))+"\n        ")]),e._v(" "),a("button",{staticClass:"btn btn-danger",attrs:{disabled:t.row.permission>=2||1===t.row.operations&&t.row.permission>=1,"data-test":"deleteUser"},on:{click:function(a){return e.deleteUser(t.row)}}},[e._v("\n          "+e._s(e.$t("admin.deleteUser"))+"\n        ")])]):a("span",{domProps:{textContent:e._s(t.formattedRow[t.column.field])}})]}}])}),e._v(" "),a("modal",{attrs:{id:"modal-permission",title:e.$t(this.$t("admin.newPermission")),center:""},on:{confirm:e.changePermission}},[a("label",{staticClass:"mr-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.permission,expression:"permission"}],attrs:{type:"radio",name:"permission"},domProps:{value:-1,checked:e._q(e.permission,-1)},on:{change:function(t){e.permission=-1}}}),e._v("\n      "+e._s(e.$t("admin.banned"))+"\n    ")]),e._v(" "),a("label",{staticClass:"mr-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.permission,expression:"permission"}],attrs:{type:"radio",name:"permission"},domProps:{value:0,checked:e._q(e.permission,0)},on:{change:function(t){e.permission=0}}}),e._v("\n      "+e._s(e.$t("admin.normal"))+"\n    ")]),e._v(" "),2===e.editingUser.operations?a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.permission,expression:"permission"}],attrs:{type:"radio",name:"permission"},domProps:{value:1,checked:e._q(e.permission,1)},on:{change:function(t){e.permission=1}}}),e._v("\n      "+e._s(e.$t("admin.admin"))+"\n    ")]):e._e()])],1)}),[],!1,null,null,null);t.default=p.exports},42:function(e,t,a){"use strict";var n=a(1);t.a=n.a.extend({data(){return{tableOptions:{search:{enabled:!0,placeholder:this.$t("vendor.datatable.search")},pagination:{enabled:!0,nextLabel:this.$t("vendor.datatable.next"),prevLabel:this.$t("vendor.datatable.prev"),rowsPerPageLabel:this.$t("vendor.datatable.rowsPerPage"),allLabel:this.$t("vendor.datatable.all"),ofLabel:this.$t("vendor.datatable.of")}}}}})},43:function(e,t,a){"use strict";function n(e){return t=>{if(!t)return e}}a.d(t,"a",(function(){return n}))},7:function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a=e[1]||"",n=e[3];if(!n)return a;if(t&&"function"==typeof btoa){var s=(r=n,o=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(c," */")),i=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[a].concat(i).concat([s]).join("\n")}var r,o,c;return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,n){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(n)for(var i=0;i<this.length;i++){var r=this[i][0];null!=r&&(s[r]=!0)}for(var o=0;o<e.length;o++){var c=[].concat(e[o]);n&&s[c[0]]||(a&&(c[2]?c[2]="".concat(a," and ").concat(c[2]):c[2]=a),t.push(c))}},t}},75:function(e,t,a){"use strict";var n=a(1);t.a=n.a.extend({data:()=>({columns:[{field:"id"}],totalRecords:0,serverParams:{sortField:"id",sortType:"asc",page:1,perPage:10,search:""}}),created(){this.serverParams.sortField=this.columns[0].field},methods:{fetchData:()=>Promise.resolve(),onPageChange(e){this.serverParams.page=e.currentPage,this.fetchData()},onPerPageChange(e){this.serverParams.perPage=e.currentPerPage,this.fetchData()},onSortChange([e]){this.serverParams.sortType=e.type,this.serverParams.sortField=e.field,this.fetchData()},onSearch(e){this.serverParams.search=e.searchTerm,this.fetchData()}}})},8:function(e,t,a){"use strict";function n(e,t){for(var a=[],n={},s=0;s<t.length;s++){var i=t[s],r=i[0],o={id:e+":"+s,css:i[1],media:i[2],sourceMap:i[3]};n[r]?n[r].parts.push(o):a.push(n[r]={id:r,parts:[o]})}return a}a.r(t),a.d(t,"default",(function(){return f}));var s="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!s)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},r=s&&(document.head||document.getElementsByTagName("head")[0]),o=null,c=0,d=!1,l=function(){},u=null,m="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,t,a,s){d=a,u=s||{};var r=n(e,t);return h(r),function(t){for(var a=[],s=0;s<r.length;s++){var o=r[s];(c=i[o.id]).refs--,a.push(c)}t?h(r=n(e,t)):r=[];for(s=0;s<a.length;s++){var c;if(0===(c=a[s]).refs){for(var d=0;d<c.parts.length;d++)c.parts[d]();delete i[c.id]}}}}function h(e){for(var t=0;t<e.length;t++){var a=e[t],n=i[a.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](a.parts[s]);for(;s<a.parts.length;s++)n.parts.push(v(a.parts[s]));n.parts.length>a.parts.length&&(n.parts.length=a.parts.length)}else{var r=[];for(s=0;s<a.parts.length;s++)r.push(v(a.parts[s]));i[a.id]={id:a.id,refs:1,parts:r}}}}function g(){var e=document.createElement("style");return e.type="text/css",r.appendChild(e),e}function v(e){var t,a,n=document.querySelector("style["+m+'~="'+e.id+'"]');if(n){if(d)return l;n.parentNode.removeChild(n)}if(p){var s=c++;n=o||(o=g()),t=y.bind(null,n,s,!1),a=y.bind(null,n,s,!0)}else n=g(),t=$.bind(null,n),a=function(){n.parentNode.removeChild(n)};return t(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;t(e=n)}else a()}}var b,w=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function y(e,t,a,n){var s=a?"":n.css;if(e.styleSheet)e.styleSheet.cssText=w(t,s);else{var i=document.createTextNode(s),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(i,r[t]):e.appendChild(i)}}function $(e,t){var a=t.css,n=t.media,s=t.sourceMap;if(n&&e.setAttribute("media",n),u.ssrId&&e.setAttribute(m,t.id),s&&(a+="\n/*# sourceURL="+s.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}}}]);