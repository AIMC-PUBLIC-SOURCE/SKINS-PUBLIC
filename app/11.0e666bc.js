(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{123:function(t,e,s){"use strict";var a=s(1),i=s(3),n=s(43),r=function(t,e,s,a){return new(s||(s=Promise))((function(i,n){function r(t){try{l(a.next(t))}catch(t){n(t)}}function o(t){try{l(a.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,o)}l((a=a.apply(t,e||[])).next())}))};e.a=a.a.extend({methods:{addClosetItem(){return r(this,void 0,void 0,(function*(){let t;try{({value:t}=yield Object(i.a)({mode:"prompt",title:this.$t("skinlib.setItemName"),text:this.$t("skinlib.applyNotice"),input:this.name,validator:Object(n.a)(this.$t("skinlib.emptyItemName"))}))}catch(t){return}const{code:e,message:s}=yield this.$http.post("/user/closet/add",{tid:this.tid,name:t});0===e?(i.b.success(s),this.$emit("like-toggled",!0)):i.b.error(s)}))}}})},126:function(t,e,s){var a=s(331);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,s(8).default)("36aab3ac",a,!0,{})},132:function(t,e,s){"use strict";var a=s(0),i=s.n(a),n=s(11),r=s(3),o={name:"ApplyToPlayerDialog",components:{Modal:n.a},props:{skin:Number,cape:Number,allowAdd:{type:Boolean,default:!0}},data:()=>({players:[],search:""}),computed:{filteredPlayers(){return this.players.filter(t=>t.name.includes(this.search))}},methods:{async fetchList(){this.players=(await this.$http.get("/user/player/list")).data},async submit(t){if(!this.skin&&!this.cape)return void r.b.info(this.$t("user.emptySelectedTexture"));const{code:e,message:s}=await this.$http.post(`/user/player/set/${t}`,{skin:this.skin||void 0,cape:this.cape||void 0});0===e?(r.b.success(s),i()("#modal-use-as").modal("hide")):r.b.error(s)},avatarUrl:t=>`${blessing.base_url}/avatar/${t.tid_skin}?3d&size=45`}},l=s(10),c=Object(l.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("modal",{ref:"modal",attrs:{id:"modal-use-as",title:t.$t("user.closet.use-as.title"),"ok-button-text":t.$t("general.submit"),"flex-footer":""},scopedSlots:t._u([{key:"footer",fn:function(){return[t.allowAdd?s("a",{directives:[{name:"t",rawName:"v-t",value:"user.closet.use-as.add",expression:"'user.closet.use-as.add'"}],staticClass:"btn btn-default",attrs:{"data-toggle":"modal","data-target":"#modal-add-player",href:"#"}}):t._e(),t._v(" "),s("button",{staticClass:"btn btn-default",attrs:{"data-dismiss":"modal"}},[t._v("\n      "+t._s(t.$t("general.cancel"))+"\n    ")])]},proxy:!0}])},[0!==t.players.length?[s("div",{staticClass:"form-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:t.$t("user.typeToSearch")},domProps:{value:t.search},on:{input:function(e){e.target.composing||(t.search=e.target.value)}}})]),t._v(" "),t._l(t.filteredPlayers,(function(e){return s("button",{key:e.pid,staticClass:"btn btn-block btn-outline-info text-left",on:{click:function(s){return t.submit(e.pid)}}},[s("img",{attrs:{src:t.avatarUrl(e),width:"45",height:"45"}}),t._v("Â \n      "),s("span",[t._v(t._s(e.name))])])}))]:s("p",{directives:[{name:"t",rawName:"v-t",value:"user.closet.use-as.empty",expression:"'user.closet.use-as.empty'"}]})],2)}),[],!1,null,null,null);e.a=c.exports},32:function(t,e,s){"use strict";var a=s(1),i=s(4);e.a=a.a.extend({mounted(){i.a("mounted",{el:this.$root.$options.el})}})},330:function(t,e,s){"use strict";var a=s(126);s.n(a).a},331:function(t,e,s){(e=s(7)(!1)).push([t.i,".table > tbody > tr > td {\n  border-top: 0;\n}\n.table > tbody > tr > td:first-child {\n  min-width: 30%;\n}\n",""]),t.exports=e},365:function(t,e,s){"use strict";s.r(e);var a=s(11),i=s(53),n=s(92),r=s(123),o=s(65),l=s(32),c=s(66),d=s(132),u=s(3),p=s(43),h={name:"Show",components:{ApplyToPlayerDialog:d.a,Modal:a.a,Portal:i.a,Previewer:()=>Promise.all([s.e(1),s.e(2)]).then(s.bind(null,335))},mixins:[l.a,r.a,o.a,n.a,c.a],props:{baseUrl:{type:String,default:blessing.base_url}},data(){return{tid:+this.$route[1],name:"",type:"steve",likes:0,hash:"",uploader:0,size:0,uploadAt:"",public:!0,editingType:"steve",liked:blessing.extra.inCloset,canBeDownloaded:blessing.extra.download,currentUid:blessing.extra.currentUid,admin:blessing.extra.admin,uploaderNickName:blessing.extra.nickname,reportScore:blessing.extra.report,badges:blessing.extra.badges,disablePortal:!1}},computed:{anonymous(){return!this.currentUid},hasEditPermission(){return this.uploader===this.currentUid||this.admin},togglePrivacyText(){return this.public?"skinlib.setAsPrivate":"skinlib.setAsPublic"},textureUrl(){return`${this.baseUrl}/textures/${this.hash}`}},beforeMount(){this.fetchData()},methods:{async fetchData(){const{data:t={}}=await this.$http.get(`/skinlib/info/${this.tid}`);Object.assign(this.$data,t),this.uploadAt=t.upload_at},async addToCloset(){this.$once("like-toggled",()=>{this.liked=!0,this.likes+=1}),await this.addClosetItem()},async removeFromCloset(){this.$once("item-removed",()=>{this.liked=!1,this.likes-=1}),await this.removeClosetItem()},download(){const t=document.createElement("a");t.href=`${this.baseUrl}/raw/${this.tid}`,t.download=`${this.name}.png`;const e=new MouseEvent("click");t.dispatchEvent(e)},async changeTextureName(){let t;try{({value:t}=await Object(u.a)({mode:"prompt",text:this.$t("skinlib.setNewTextureName"),input:this.name,validator:Object(p.a)(this.$t("skinlib.emptyNewTextureName"))}))}catch{return}const{code:e,message:s}=await this.$http.post("/skinlib/rename",{tid:this.tid,new_name:t});0===e?(this.name=t,u.b.success(s)):u.b.error(s)},async changeModel(){const{code:t,message:e}=await this.$http.post("/skinlib/model",{tid:this.tid,model:this.editingType});0===t?(this.type=this.editingType,u.b.success(e)):u.b.error(e)},async togglePrivacy(){try{await Object(u.a)({text:this.public?this.$t("skinlib.setPrivateNotice"):this.$t("skinlib.setPublicNotice")})}catch{return}const{code:t,message:e}=await this.$http.post("/skinlib/privacy",{tid:this.tid});0===t?(u.b.success(e),this.public=!this.public):u.b.error(e)},async deleteTexture(){try{await Object(u.a)({text:this.$t("skinlib.deleteNotice"),okButtonType:"danger"})}catch{return}const{code:t,message:e}=await this.$http.post("/skinlib/delete",{tid:this.tid});0===t?(u.b.success(e),setTimeout(()=>window.location=`${this.baseUrl}/skinlib`,1e3)):u.b.error(e)},async report(){const t=(()=>this.reportScore>0?this.$t("skinlib.report.positive",{score:this.reportScore}):this.reportScore<0?this.$t("skinlib.report.negative",{score:-this.reportScore}):"")();let e;try{({value:e}=await Object(u.a)({mode:"prompt",title:this.$t("skinlib.report.title"),text:t,placeholder:this.$t("skinlib.report.reason")}))}catch{return}const{code:s,message:a}=await this.$http.post("/skinlib/report",{tid:this.tid,reason:e});0===s?u.b.success(a):u.b.error(a)},fetchPlayersList(){this.$refs.useAs.fetchList()}}},v=(s(330),s(10)),m=Object(v.a)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("portal",{attrs:{selector:"#previewer",disabled:t.disablePortal}},[s("previewer",{attrs:{skin:"cape"!==t.type&&t.textureUrl,cape:"cape"===t.type?t.textureUrl:"",model:t.type,"init-position-z":60},scopedSlots:t._u([{key:"footer",fn:function(){return[t.anonymous?s("button",{staticClass:"btn btn-outline-secondary",attrs:{disabled:"",title:t.$t("skinlib.show.anonymous")}},[t._v("\n          "+t._s(t.$t("skinlib.addToCloset"))+"\n        ")]):s("div",{staticClass:"d-flex justify-content-between"},[s("div",[t.liked?s("button",{staticClass:"btn btn-outline-success mr-2",attrs:{"data-toggle":"modal","data-target":"#modal-use-as"},on:{click:t.fetchPlayersList}},[t._v("\n              "+t._s(t.$t("skinlib.apply"))+"\n            ")]):t._e(),t._v(" "),t.liked?s("button",{staticClass:"btn btn-outline-primary mr-2",attrs:{"data-test":"removeFromCloset"},on:{click:t.removeFromCloset}},[t._v("\n              "+t._s(t.$t("skinlib.removeFromCloset"))+"\n            ")]):s("button",{staticClass:"btn btn-outline-primary mr-2",attrs:{"data-test":"addToCloset"},on:{click:t.addToCloset}},[t._v("\n              "+t._s(t.$t("skinlib.addToCloset"))+"\n            ")]),t._v(" "),"cape"!==t.type?s("button",{staticClass:"btn btn-outline-info mr-2",attrs:{"data-test":"setAsAvatar"},on:{click:t.setAsAvatar}},[t._v("\n              "+t._s(t.$t("user.setAsAvatar"))+"\n            ")]):t._e(),t._v(" "),t.canBeDownloaded?s("button",{staticClass:"btn btn-outline-info mr-2",attrs:{"data-test":"download"},on:{click:t.download}},[t._v("\n              "+t._s(t.$t("skinlib.show.download"))+"\n            ")]):t._e(),t._v(" "),s("button",{staticClass:"btn btn-outline-info mr-2",attrs:{"data-test":"report"},on:{click:t.report}},[t._v("\n              "+t._s(t.$t("skinlib.report.title"))+"\n            ")])]),t._v(" "),s("div",{staticClass:"pt-2 likes",class:[t.liked?"text-red":"text-gray"],attrs:{title:t.$t("skinlib.show.likes")}},[s("i",{staticClass:"fas fa-heart"}),t._v(" "),s("span",[t._v(t._s(t.likes))])])])]},proxy:!0}])})],1),t._v(" "),s("portal",{attrs:{selector:"#texture-info",disabled:t.disablePortal}},[s("div",{staticClass:"card card-primary"},[s("div",{staticClass:"card-header"},[s("h3",{directives:[{name:"t",rawName:"v-t",value:"skinlib.show.detail",expression:"'skinlib.show.detail'"}],staticClass:"card-title"})]),t._v(" "),s("div",{staticClass:"card-body"},[s("table",{staticClass:"table"},[s("tbody",[s("tr",[s("td",{directives:[{name:"t",rawName:"v-t",value:"skinlib.show.name",expression:"'skinlib.show.name'"}]}),t._v(" "),s("td",[t._v("\n                "+t._s(t._f("truncate")(t.name))+"\n                "),t.hasEditPermission?s("small",[s("a",{directives:[{name:"t",rawName:"v-t",value:"skinlib.show.edit",expression:"'skinlib.show.edit'"}],attrs:{href:"#"},on:{click:t.changeTextureName}})]):t._e()])]),t._v(" "),s("tr",[s("td",{directives:[{name:"t",rawName:"v-t",value:"skinlib.show.model",expression:"'skinlib.show.model'"}]}),t._v(" "),s("td",["cape"===t.type?s("span",[t._v(t._s(t.$t("general.cape")))]):s("span",[t._v(t._s(t.type))]),t._v(" "),t.hasEditPermission?s("small",[s("a",{attrs:{href:"#","data-toggle":"modal","data-target":"#modal-type"},on:{click:function(e){t.editingType=t.type}}},[t._v("\n                    "+t._s(t.$t("skinlib.show.edit"))+"\n                  ")])]):t._e()])]),t._v(" "),s("tr",[s("td",[t._v("Hash")]),t._v(" "),s("td",[s("span",{attrs:{title:t.hash}},[t._v(t._s(t.hash.slice(0,15))+"...")])])]),t._v(" "),s("tr",[s("td",{directives:[{name:"t",rawName:"v-t",value:"skinlib.show.size",expression:"'skinlib.show.size'"}]}),t._v(" "),s("td",[t._v(t._s(t.size)+" KB")])]),t._v(" "),s("tr",[s("td",{directives:[{name:"t",rawName:"v-t",value:"skinlib.show.uploader",expression:"'skinlib.show.uploader'"}]}),t._v(" "),null!==t.uploaderNickName?s("td",[s("a",{attrs:{href:t.baseUrl+"/skinlib?filter="+("cape"===t.type?"cape":"skin")+"&uploader="+t.uploader}},[t._v(t._s(t.uploaderNickName))]),t._v(" "),s("br"),t._v(" "),t._l(t.badges,(function(e,a){return s("span",{key:a,staticClass:"badge mr-2",class:"bg-"+e.color},[t._v(t._s(e.text))])}))],2):s("td",[s("span",{directives:[{name:"t",rawName:"v-t",value:"general.unexistent-user",expression:"'general.unexistent-user'"}]})])]),t._v(" "),s("tr",[s("td",{directives:[{name:"t",rawName:"v-t",value:"skinlib.show.upload-at",expression:"'skinlib.show.upload-at'"}]}),t._v(" "),s("td",[t._v(t._s(t.uploadAt))])])])])])])]),t._v(" "),s("portal",{attrs:{selector:"#operations",disabled:t.disablePortal}},[t.hasEditPermission?s("div",{staticClass:"card card-warning"},[s("div",{staticClass:"card-header"},[s("h3",{directives:[{name:"t",rawName:"v-t",value:"admin.operationsTitle",expression:"'admin.operationsTitle'"}],staticClass:"card-title"})]),t._v(" "),s("div",{staticClass:"card-body"},[s("p",{directives:[{name:"t",rawName:"v-t",value:"skinlib.show.manage-notice",expression:"'skinlib.show.manage-notice'"}]})]),t._v(" "),s("div",{staticClass:"card-footer"},[s("div",{staticClass:"container d-flex justify-content-between"},[s("button",{staticClass:"btn btn-warning",on:{click:t.togglePrivacy}},[t._v("\n            "+t._s(t.$t(t.togglePrivacyText))+"\n          ")]),t._v(" "),s("button",{staticClass:"btn btn-danger",on:{click:t.deleteTexture}},[t._v("\n            "+t._s(t.$t("skinlib.show.delete-texture"))+"\n          ")])])])]):t._e()]),t._v(" "),s("portal",{attrs:{selector:"#modals",disabled:t.disablePortal}},[s("apply-to-player-dialog",{ref:"useAs",attrs:{"allow-add":!1,skin:"cape"!==t.type?t.tid:0,cape:"cape"===t.type?t.tid:0}}),t._v(" "),s("modal",{attrs:{id:"modal-type",title:t.$t(this.$t("skinlib.setNewTextureModel")),center:""},on:{confirm:t.changeModel}},[s("label",{staticClass:"mr-3"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.editingType,expression:"editingType"}],attrs:{type:"radio",name:"type",value:"steve"},domProps:{checked:t._q(t.editingType,"steve")},on:{change:function(e){t.editingType="steve"}}}),t._v("\n        Steve\n      ")]),t._v(" "),s("label",{staticClass:"mr-3"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.editingType,expression:"editingType"}],attrs:{type:"radio",name:"type",value:"alex"},domProps:{checked:t._q(t.editingType,"alex")},on:{change:function(e){t.editingType="alex"}}}),t._v("\n        Alex\n      ")]),t._v(" "),s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.editingType,expression:"editingType"}],attrs:{type:"radio",name:"type",value:"cape"},domProps:{checked:t._q(t.editingType,"cape")},on:{change:function(e){t.editingType="cape"}}}),t._v("\n        "+t._s(t.$t("general.cape"))+"\n      ")])])],1)],1)}),[],!1,null,null,null);e.default=m.exports},43:function(t,e,s){"use strict";function a(t){return e=>{if(!e)return t}}s.d(e,"a",(function(){return a}))},53:function(t,e,s){"use strict";var a=s(1);e.a=a.a.extend({name:"Portal",props:{selector:{required:!0,type:String},tag:{type:String,default:"div"},disabled:{type:Boolean,default:!1}},mounted(){if(this.disabled)return;const t=document.querySelector(this.selector);t&&(t.firstChild?t.replaceChild(this.$el,t.firstChild):t.appendChild(this.$el))},render(t){return t(this.tag,[this.$slots.default])}})},65:function(t,e,s){"use strict";var a=s(1),i=s(3),n=function(t,e,s,a){return new(s||(s=Promise))((function(i,n){function r(t){try{l(a.next(t))}catch(t){n(t)}}function o(t){try{l(a.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,o)}l((a=a.apply(t,e||[])).next())}))};e.a=a.a.extend({methods:{removeClosetItem(){return n(this,void 0,void 0,(function*(){try{yield Object(i.a)({text:this.$t("user.removeFromClosetNotice"),okButtonType:"danger"})}catch(t){return}const{code:t,message:e}=yield this.$http.post(`/user/closet/remove/${this.tid}`);0===t?(this.$emit("item-removed"),i.b.success(e)):i.b.error(e)}))}}})},66:function(t,e,s){"use strict";var a=s(1);e.a=a.a.extend({filters:{truncate:(t="")=>t.length>15?`${t.slice(0,15)}...`:t}})},7:function(t,e,s){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var s=function(t,e){var s=t[1]||"",a=t[3];if(!a)return s;if(e&&"function"==typeof btoa){var i=(r=a,o=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(l," */")),n=a.sources.map((function(t){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(t," */")}));return[s].concat(n).concat([i]).join("\n")}var r,o,l;return[s].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(s,"}"):s})).join("")},e.i=function(t,s,a){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(a)for(var n=0;n<this.length;n++){var r=this[n][0];null!=r&&(i[r]=!0)}for(var o=0;o<t.length;o++){var l=[].concat(t[o]);a&&i[l[0]]||(s&&(l[2]?l[2]="".concat(s," and ").concat(l[2]):l[2]=s),e.push(l))}},e}},8:function(t,e,s){"use strict";function a(t,e){for(var s=[],a={},i=0;i<e.length;i++){var n=e[i],r=n[0],o={id:t+":"+i,css:n[1],media:n[2],sourceMap:n[3]};a[r]?a[r].parts.push(o):s.push(a[r]={id:r,parts:[o]})}return s}s.r(e),s.d(e,"default",(function(){return v}));var i="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!i)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var n={},r=i&&(document.head||document.getElementsByTagName("head")[0]),o=null,l=0,c=!1,d=function(){},u=null,p="data-vue-ssr-id",h="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function v(t,e,s,i){c=s,u=i||{};var r=a(t,e);return m(r),function(e){for(var s=[],i=0;i<r.length;i++){var o=r[i];(l=n[o.id]).refs--,s.push(l)}e?m(r=a(t,e)):r=[];for(i=0;i<s.length;i++){var l;if(0===(l=s[i]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete n[l.id]}}}}function m(t){for(var e=0;e<t.length;e++){var s=t[e],a=n[s.id];if(a){a.refs++;for(var i=0;i<a.parts.length;i++)a.parts[i](s.parts[i]);for(;i<s.parts.length;i++)a.parts.push(f(s.parts[i]));a.parts.length>s.parts.length&&(a.parts.length=s.parts.length)}else{var r=[];for(i=0;i<s.parts.length;i++)r.push(f(s.parts[i]));n[s.id]={id:s.id,refs:1,parts:r}}}}function b(){var t=document.createElement("style");return t.type="text/css",r.appendChild(t),t}function f(t){var e,s,a=document.querySelector("style["+p+'~="'+t.id+'"]');if(a){if(c)return d;a.parentNode.removeChild(a)}if(h){var i=l++;a=o||(o=b()),e=_.bind(null,a,i,!1),s=_.bind(null,a,i,!0)}else a=b(),e=k.bind(null,a),s=function(){a.parentNode.removeChild(a)};return e(t),function(a){if(a){if(a.css===t.css&&a.media===t.media&&a.sourceMap===t.sourceMap)return;e(t=a)}else s()}}var y,g=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function _(t,e,s,a){var i=s?"":a.css;if(t.styleSheet)t.styleSheet.cssText=g(e,i);else{var n=document.createTextNode(i),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(n,r[e]):t.appendChild(n)}}function k(t,e){var s=e.css,a=e.media,i=e.sourceMap;if(a&&t.setAttribute("media",a),u.ssrId&&t.setAttribute(p,e.id),i&&(s+="\n/*# sourceURL="+i.sources[0]+" */",s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),t.styleSheet)t.styleSheet.cssText=s;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(s))}}},92:function(t,e,s){"use strict";var a=s(1),i=s(3),n=function(t,e,s,a){return new(s||(s=Promise))((function(i,n){function r(t){try{l(a.next(t))}catch(t){n(t)}}function o(t){try{l(a.throw(t))}catch(t){n(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,o)}l((a=a.apply(t,e||[])).next())}))};e.a=a.a.extend({methods:{setAsAvatar(){return n(this,void 0,void 0,(function*(){try{yield Object(i.a)({title:this.$t("user.setAvatar"),text:this.$t("user.setAvatarNotice")})}catch(t){return}const{code:t,message:e}=yield this.$http.post("/user/profile/avatar",{tid:this.tid});0===t?(i.b.success(e),Array.from(document.querySelectorAll('[alt="User Image"]')).forEach(t=>t.src+=`?${(new Date).getTime()}`)):i.b.error(e)}))}}})}}]);