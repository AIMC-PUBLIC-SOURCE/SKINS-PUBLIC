(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{131:function(e,t,a){"use strict";var r=a(11),s=a(3),n={name:"AddPlayerDialog",components:{Modal:r.a},data:()=>({name:"",rule:blessing.extra.rule,length:blessing.extra.length}),methods:{async addPlayer(){const{code:e,message:t}=await this.$http.post("/user/player/add",{name:this.name});0===e?(s.b.success(t),this.$emit("add")):s.b.error(t)}}},i=a(10),l=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{id:"modal-add-player",title:e.$t("user.player.add-player"),"ok-button-text":e.$t("general.submit"),"flex-footer":"",center:""},on:{confirm:e.addPlayer}},[a("table",{staticClass:"table"},[a("tbody",[a("tr",[a("td",{directives:[{name:"t",rawName:"v-t",value:"general.player.player-name",expression:"'general.player.player-name'"}],staticClass:"key"}),e._v(" "),a("td",{staticClass:"value"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})])])])]),e._v(" "),a("div",{staticClass:"callout callout-info"},[a("ul",{staticClass:"m-0 p-0 pl-3"},[a("li",[e._v(e._s(e.rule))]),e._v(" "),a("li",[e._v(e._s(e.length))])])])])}),[],!1,null,null,null);t.a=l.exports},199:function(e,t,a){"use strict";var r=a(94);a.n(r).a},200:function(e,t,a){(t=a(7)(!1)).push([e.i,".player {\n  cursor: pointer;\n  border-bottom: 1px solid #f4f4f4;\n}\n.player .pid,\n.player .player-name {\n  padding-top: 13px;\n}\n.player:last-child {\n  border-bottom: none;\n}\n.player-selected {\n  background-color: #f5f5f5;\n}\n.skin2d {\n  float: right;\n  max-height: 64px;\n  width: 64px;\n  font-size: 16px;\n}\n#preview-2d > p {\n  height: 64px;\n  line-height: 64px;\n}\n",""]),e.exports=t},32:function(e,t,a){"use strict";var r=a(1),s=a(4);t.a=r.a.extend({mounted(){s.a("mounted",{el:this.$root.$options.el})}})},351:function(e,t,a){"use strict";a.r(t);var r=a(11),s=a(53),n=a(131),i=a(32),l=a(3),o=a(43),c={name:"Players",components:{AddPlayerDialog:n.a,Modal:r.a,Portal:s.a,Previewer:()=>Promise.all([a.e(1),a.e(2)]).then(a.bind(null,335))},mixins:[i.a],props:{baseUrl:{type:String,default:blessing.base_url}},data:()=>({players:[],selected:0,using3dPreviewer:!0,skinUrl:"",capeUrl:"",model:"steve",preview2d:{skin:0,cape:0},clear:{skin:!1,cape:!1},disablePortal:!1}),async beforeMount(){await this.fetchPlayers(),1===this.players.length&&this.preview(this.players[0])},methods:{async fetchPlayers(){this.players=(await this.$http.get("/user/player/list")).data},togglePreviewer(){this.using3dPreviewer=!this.using3dPreviewer},async preview(e){if(this.selected=e.pid,this.preview2d.skin=e.tid_skin,this.preview2d.cape=e.tid_cape,e.tid_skin){const{data:t}=await this.$http.get(`/skinlib/info/${e.tid_skin}`);this.skinUrl=`${this.baseUrl}/textures/${t.hash}`,this.model=t.type}else this.skinUrl="",this.model="steve";if(e.tid_cape){const{data:t}=await this.$http.get(`/skinlib/info/${e.tid_cape}`);this.capeUrl=`${this.baseUrl}/textures/${t.hash}`}else this.capeUrl=""},async changeName(e){let t;try{({value:t}=await Object(l.a)({mode:"prompt",text:this.$t("user.changePlayerName"),input:e.name,validator:Object(o.a)(this.$t("user.emptyPlayerName"))}))}catch{return}const{code:a,message:r}=await this.$http.post(`/user/player/rename/${e.pid}`,{name:t});0===a?(l.b.success(r),e.name=t):l.b.error(r)},async clearTexture(){if(Object.values(this.clear).every(e=>!e))return void l.b.error(this.$t("user.noClearChoice"));const{code:e,message:t}=await this.$http.post(`/user/player/texture/clear/${this.selected}`,this.clear);if(0===e){l.b.success(t);const e=this.players.find(({pid:e})=>e===this.selected);Object.keys(this.clear).filter(e=>this.clear[e]).forEach(t=>e[`tid_${t}`]=0)}else l.b.error(t)},async deletePlayer(e,t){try{await Object(l.a)({title:this.$t("user.deletePlayer"),text:this.$t("user.deletePlayerNotice"),okButtonType:"danger"})}catch{return}const{code:a,message:r}=await this.$http.post(`/user/player/delete/${e.pid}`);0===a?(this.$delete(this.players,t),l.b.success(r)):l.b.error(r)}}},d=(a(199),a(10)),p=Object(d.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("portal",{attrs:{selector:"#players-list",disabled:e.disablePortal}},[a("div",{staticClass:"card card-primary"},[a("div",{staticClass:"card-body table-responsive p-0"},[a("table",{staticClass:"table table-hover"},[a("thead",[a("tr",[a("th",[e._v("PID")]),e._v(" "),a("th",{directives:[{name:"t",rawName:"v-t",value:"general.player.player-name",expression:"'general.player.player-name'"}]}),e._v(" "),a("th",{directives:[{name:"t",rawName:"v-t",value:"user.player.operation",expression:"'user.player.operation'"}]})])]),e._v(" "),a("tbody",e._l(e.players,(function(t,r){return a("tr",{key:t.pid,staticClass:"player",class:{"player-selected":t.pid===e.selected},on:{click:function(a){return e.preview(t)}}},[a("td",{staticClass:"pid"},[e._v(e._s(t.pid))]),e._v(" "),a("td",{staticClass:"player-name"},[e._v(e._s(t.name))]),e._v(" "),a("td",[a("button",{staticClass:"btn btn-default",on:{click:function(a){return e.changeName(t)}}},[e._v("\n                  "+e._s(e.$t("user.player.edit-pname"))+"\n                ")]),e._v(" "),a("button",{staticClass:"btn btn-warning",attrs:{"data-toggle":"modal","data-target":"#modal-clear-texture"}},[e._v("\n                  "+e._s(e.$t("user.player.delete-texture"))+"\n                ")]),e._v(" "),a("button",{staticClass:"btn btn-danger",on:{click:function(a){return e.deletePlayer(t,r)}}},[e._v("\n                  "+e._s(e.$t("user.player.delete-player"))+"\n                ")])])])})),0)])]),e._v(" "),a("div",{staticClass:"card-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-toggle":"modal","data-target":"#modal-add-player"}},[a("i",{staticClass:"fas fa-plus",attrs:{"aria-hidden":"true"}}),e._v("Â "+e._s(e.$t("user.player.add-player"))+"\n        ")])])])]),e._v(" "),a("portal",{attrs:{selector:"#previewer",disabled:e.disablePortal}},[e.using3dPreviewer?a("previewer",{attrs:{skin:e.skinUrl,cape:e.capeUrl,model:e.model,title:"user.player.player-info"},scopedSlots:e._u([{key:"footer",fn:function(){return[a("button",{staticClass:"btn btn-default",attrs:{"data-test":"to2d"},on:{click:e.togglePreviewer}},[e._v("\n          "+e._s(e.$t("user.switch2dPreview"))+"\n        ")])]},proxy:!0}],null,!1,3536689170)}):a("div",{staticClass:"card"},[a("div",{staticClass:"card-header card-outline"},[a("h3",{staticClass:"card-title",domProps:{innerHTML:e._s(e.$t("user.player.player-info"))}})]),e._v(" "),a("div",{staticClass:"card-body"},[a("div",{attrs:{id:"preview-2d"}},[a("p",[e._v("\n            "+e._s(e.$t("general.skin"))+"\n            "),e.preview2d.skin?a("a",{attrs:{href:e.baseUrl+"/skinlib/show/"+e.preview2d.skin}},[a("img",{staticClass:"skin2d",attrs:{src:e.baseUrl+"/preview/"+e.preview2d.skin+"?height=128"}})]):a("span",{directives:[{name:"t",rawName:"v-t",value:"user.player.texture-empty",expression:"'user.player.texture-empty'"}],staticClass:"skin2d"})]),e._v(" "),a("p",[e._v("\n            "+e._s(e.$t("general.cape"))+"\n            "),e.preview2d.cape?a("a",{attrs:{href:e.baseUrl+"/skinlib/show/"+e.preview2d.cape}},[a("img",{staticClass:"skin2d",attrs:{src:e.baseUrl+"/preview/"+e.preview2d.cape+"?height=128"}})]):a("span",{directives:[{name:"t",rawName:"v-t",value:"user.player.texture-empty",expression:"'user.player.texture-empty'"}],staticClass:"skin2d"})])])]),e._v(" "),a("div",{staticClass:"card-footer"},[a("button",{staticClass:"btn btn-default",on:{click:e.togglePreviewer}},[e._v("\n          "+e._s(e.$t("user.switch3dPreview"))+"\n        ")])])])],1),e._v(" "),a("portal",{attrs:{selector:"#modals",disabled:e.disablePortal}},[a("add-player-dialog",{on:{add:e.fetchPlayers}}),e._v(" "),a("modal",{attrs:{id:"modal-clear-texture",title:e.$t("user.chooseClearTexture")},on:{confirm:e.clearTexture}},[a("label",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.clear.skin,expression:"clear.skin"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.clear.skin)?e._i(e.clear.skin,null)>-1:e.clear.skin},on:{change:function(t){var a=e.clear.skin,r=t.target,s=!!r.checked;if(Array.isArray(a)){var n=e._i(a,null);r.checked?n<0&&e.$set(e.clear,"skin",a.concat([null])):n>-1&&e.$set(e.clear,"skin",a.slice(0,n).concat(a.slice(n+1)))}else e.$set(e.clear,"skin",s)}}}),e._v(" "+e._s(e.$t("general.skin"))+"\n      ")]),e._v(" "),a("br"),e._v(" "),a("label",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.clear.cape,expression:"clear.cape"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.clear.cape)?e._i(e.clear.cape,null)>-1:e.clear.cape},on:{change:function(t){var a=e.clear.cape,r=t.target,s=!!r.checked;if(Array.isArray(a)){var n=e._i(a,null);r.checked?n<0&&e.$set(e.clear,"cape",a.concat([null])):n>-1&&e.$set(e.clear,"cape",a.slice(0,n).concat(a.slice(n+1)))}else e.$set(e.clear,"cape",s)}}}),e._v(" "+e._s(e.$t("general.cape"))+"\n      ")])])],1)],1)}),[],!1,null,null,null);t.default=p.exports},43:function(e,t,a){"use strict";function r(e){return t=>{if(!t)return e}}a.d(t,"a",(function(){return r}))},53:function(e,t,a){"use strict";var r=a(1);t.a=r.a.extend({name:"Portal",props:{selector:{required:!0,type:String},tag:{type:String,default:"div"},disabled:{type:Boolean,default:!1}},mounted(){if(this.disabled)return;const e=document.querySelector(this.selector);e&&(e.firstChild?e.replaceChild(this.$el,e.firstChild):e.appendChild(this.$el))},render(e){return e(this.tag,[this.$slots.default])}})},7:function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a=e[1]||"",r=e[3];if(!r)return a;if(t&&"function"==typeof btoa){var s=(i=r,l=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(o," */")),n=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[a].concat(n).concat([s]).join("\n")}var i,l,o;return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,r){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(r)for(var n=0;n<this.length;n++){var i=this[n][0];null!=i&&(s[i]=!0)}for(var l=0;l<e.length;l++){var o=[].concat(e[l]);r&&s[o[0]]||(a&&(o[2]?o[2]="".concat(a," and ").concat(o[2]):o[2]=a),t.push(o))}},t}},8:function(e,t,a){"use strict";function r(e,t){for(var a=[],r={},s=0;s<t.length;s++){var n=t[s],i=n[0],l={id:e+":"+s,css:n[1],media:n[2],sourceMap:n[3]};r[i]?r[i].parts.push(l):a.push(r[i]={id:i,parts:[l]})}return a}a.r(t),a.d(t,"default",(function(){return v}));var s="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!s)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var n={},i=s&&(document.head||document.getElementsByTagName("head")[0]),l=null,o=0,c=!1,d=function(){},p=null,u="data-vue-ssr-id",h="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function v(e,t,a,s){c=a,p=s||{};var i=r(e,t);return f(i),function(t){for(var a=[],s=0;s<i.length;s++){var l=i[s];(o=n[l.id]).refs--,a.push(o)}t?f(i=r(e,t)):i=[];for(s=0;s<a.length;s++){var o;if(0===(o=a[s]).refs){for(var c=0;c<o.parts.length;c++)o.parts[c]();delete n[o.id]}}}}function f(e){for(var t=0;t<e.length;t++){var a=e[t],r=n[a.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](a.parts[s]);for(;s<a.parts.length;s++)r.parts.push(y(a.parts[s]));r.parts.length>a.parts.length&&(r.parts.length=a.parts.length)}else{var i=[];for(s=0;s<a.parts.length;s++)i.push(y(a.parts[s]));n[a.id]={id:a.id,refs:1,parts:i}}}}function m(){var e=document.createElement("style");return e.type="text/css",i.appendChild(e),e}function y(e){var t,a,r=document.querySelector("style["+u+'~="'+e.id+'"]');if(r){if(c)return d;r.parentNode.removeChild(r)}if(h){var s=o++;r=l||(l=m()),t=_.bind(null,r,s,!1),a=_.bind(null,r,s,!0)}else r=m(),t=w.bind(null,r),a=function(){r.parentNode.removeChild(r)};return t(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;t(e=r)}else a()}}var g,b=(g=[],function(e,t){return g[e]=t,g.filter(Boolean).join("\n")});function _(e,t,a,r){var s=a?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,s);else{var n=document.createTextNode(s),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(n,i[t]):e.appendChild(n)}}function w(e,t){var a=t.css,r=t.media,s=t.sourceMap;if(r&&e.setAttribute("media",r),p.ssrId&&e.setAttribute(u,t.id),s&&(a+="\n/*# sourceURL="+s.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}},94:function(e,t,a){var r=a(200);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,a(8).default)("32978beb",r,!0,{})}}]);