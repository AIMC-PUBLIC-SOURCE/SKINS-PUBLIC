(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{32:function(e,t,a){"use strict";var r=a(1),n=a(4);t.a=r.a.extend({mounted(){n.a("mounted",{el:this.$root.$options.el})}})},356:function(e,t,a){"use strict";a.r(t);var r=a(55),n=(a(54),a(11)),s=a(42),i=a(75),o=a(32),l=a(3),d=a(43),c={name:"PlayersManagement",components:{Modal:n.a,VueGoodTable:r.a},mixins:[o.a,s.a,i.a],props:{baseUrl:{type:String,default:blessing.base_url}},data(){return{players:[],columns:[{field:"pid",label:"PID",type:"number"},{field:"name",label:this.$t("general.player.player-name")},{field:"uid",label:this.$t("general.player.owner"),type:"number",sortable:!1},{field:"preview",label:this.$t("general.player.previews"),globalSearchDisabled:!0,sortable:!1},{field:"last_modified",label:this.$t("general.player.last-modified"),sortable:!1},{field:"operations",label:this.$t("admin.operationsTitle"),globalSearchDisabled:!0,sortable:!1}],textureChanges:{originalIndex:-1,type:"skin",tid:""}}},beforeMount(){this.fetchData()},methods:{async fetchData(){const{data:e,totalRecords:t}=await this.$http.get(`/admin/players/list${location.search}`,!location.search&&this.serverParams);this.totalRecords=t,this.players=e},async changeTexture(){const e=this.players[this.textureChanges.originalIndex],{type:t,tid:a}=this.textureChanges,{code:r,message:n}=await this.$http.post("/admin/players?action=texture",{pid:e.pid,type:t,tid:a});0===r?(e[`tid_${t}`]=a,l.b.success(n)):l.b.error(n)},async changeName(e){let t;try{({value:t}=await Object(l.a)({mode:"prompt",text:this.$t("admin.changePlayerNameNotice"),input:e.name,validator:Object(d.a)(this.$t("admin.emptyPlayerName"))}))}catch{return}const{code:a,message:r}=await this.$http.post("/admin/players?action=name",{pid:e.pid,name:t});0===a?(e.name=t,l.b.success(r)):l.b.error(r)},async changeOwner(e){let t;try{({value:t}=await Object(l.a)({mode:"prompt",text:this.$t("admin.changePlayerOwner"),input:e.uid}))}catch{return}t=Number.parseInt(t);const{code:a,message:r}=await this.$http.post("/admin/players?action=owner",{pid:e.pid,uid:t});0===a?(e.uid=t,l.b.success(r)):l.b.error(r)},async deletePlayer({pid:e,originalIndex:t}){try{await Object(l.a)({text:this.$t("admin.deletePlayerNotice"),okButtonType:"danger"})}catch{return}const{code:a,message:r}=await this.$http.post("/admin/players?action=delete",{pid:e});0===a?(this.$delete(this.players,t),l.b.success(r)):l.b.error(r)}}},p=a(10),u=Object(p.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid"},[a("vue-good-table",{attrs:{mode:"remote",rows:e.players,"total-rows":e.totalRecords||e.players.length,columns:e.columns,"search-options":e.tableOptions.search,"pagination-options":e.tableOptions.pagination,"style-class":"vgt-table striped"},on:{"on-page-change":e.onPageChange,"on-sort-change":e.onSortChange,"on-search":e.onSearch,"on-per-page-change":e.onPerPageChange},scopedSlots:e._u([{key:"table-row",fn:function(t){return["name"===t.column.field?a("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),a("a",{attrs:{title:e.$t("admin.changePlayerName"),"data-test":"name"},on:{click:function(a){return e.changeName(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"uid"===t.column.field?a("span",[a("a",{attrs:{href:e.baseUrl+"/admin/users?uid="+t.row.uid,title:e.$t("admin.inspectHisOwner"),"data-toggle":"tooltip","data-placement":"right"}},[e._v(e._s(t.formattedRow[t.column.field]))]),e._v(" "),a("a",{attrs:{title:e.$t("admin.changeOwner"),"data-test":"owner"},on:{click:function(a){return e.changeOwner(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"preview"===t.column.field?a("span",[t.row.tid_skin?a("a",{attrs:{href:e.baseUrl+"/skinlib/show/"+t.row.tid_skin}},[a("img",{attrs:{src:e.baseUrl+"/preview/"+t.row.tid_skin+"?height=64",width:"64"}})]):e._e(),e._v(" "),t.row.tid_cape?a("a",{attrs:{href:e.baseUrl+"/skinlib/show/"+t.row.tid_cape}},[a("img",{attrs:{src:e.baseUrl+"/preview/"+t.row.tid_cape+"?height=64",width:"64"}})]):e._e()]):"operations"===t.column.field?a("span",[a("button",{staticClass:"btn btn-default",attrs:{"data-toggle":"modal","data-target":"#modal-change-texture"},on:{click:function(a){e.textureChanges.originalIndex=t.row.originalIndex}}},[e._v("\n          "+e._s(e.$t("admin.changeTexture"))+"\n        ")]),e._v(" "),a("button",{staticClass:"btn btn-danger",on:{click:function(a){return e.deletePlayer(t.row)}}},[e._v("\n          "+e._s(e.$t("admin.deletePlayer"))+"\n        ")])]):a("span",{domProps:{textContent:e._s(t.formattedRow[t.column.field])}})]}}])}),e._v(" "),a("modal",{attrs:{id:"modal-change-texture",title:e.$t("admin.changeTexture"),center:""},on:{confirm:e.changeTexture}},[a("div",{staticClass:"form-group"},[a("label",{directives:[{name:"t",rawName:"v-t",value:"admin.textureType",expression:"'admin.textureType'"}]}),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.textureChanges.type,expression:"textureChanges.type"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.textureChanges,"type",t.target.multiple?a:a[0])}}},[a("option",{directives:[{name:"t",rawName:"v-t",value:"general.skin",expression:"'general.skin'"}],attrs:{value:"skin"}}),e._v(" "),a("option",{directives:[{name:"t",rawName:"v-t",value:"general.cape",expression:"'general.cape'"}],attrs:{value:"cape"}})])]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",[e._v("TID")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.textureChanges.tid,expression:"textureChanges.tid",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:e.$t("admin.pidNotice")},domProps:{value:e.textureChanges.tid},on:{input:function(t){t.target.composing||e.$set(e.textureChanges,"tid",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})])])],1)}),[],!1,null,null,null);t.default=u.exports},42:function(e,t,a){"use strict";var r=a(1);t.a=r.a.extend({data(){return{tableOptions:{search:{enabled:!0,placeholder:this.$t("vendor.datatable.search")},pagination:{enabled:!0,nextLabel:this.$t("vendor.datatable.next"),prevLabel:this.$t("vendor.datatable.prev"),rowsPerPageLabel:this.$t("vendor.datatable.rowsPerPage"),allLabel:this.$t("vendor.datatable.all"),ofLabel:this.$t("vendor.datatable.of")}}}}})},43:function(e,t,a){"use strict";function r(e){return t=>{if(!t)return e}}a.d(t,"a",(function(){return r}))},75:function(e,t,a){"use strict";var r=a(1);t.a=r.a.extend({data:()=>({columns:[{field:"id"}],totalRecords:0,serverParams:{sortField:"id",sortType:"asc",page:1,perPage:10,search:""}}),created(){this.serverParams.sortField=this.columns[0].field},methods:{fetchData:()=>Promise.resolve(),onPageChange(e){this.serverParams.page=e.currentPage,this.fetchData()},onPerPageChange(e){this.serverParams.perPage=e.currentPerPage,this.fetchData()},onSortChange([e]){this.serverParams.sortType=e.type,this.serverParams.sortField=e.field,this.fetchData()},onSearch(e){this.serverParams.search=e.searchTerm,this.fetchData()}}})}}]);